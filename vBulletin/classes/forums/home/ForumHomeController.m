/**
 * @file
 *
 * vBulletin iOS
 * Copyright (c) 2011-2012 Ken Iovino. All Rights Reserved. 
 *
 * This application and it's source code is owned and operated by Ken Iovino. Use of this 
 * application and it's source code is strictly prohibited unless otherwise specified in a written 
 * agreement.
 *
 * This file may not be redistributed in whole or significant part.
 */

// Header File
#import "ForumHomeController.h"

// Application Stylesheet
#import "vBulletinStyleSheet.h"

#import "ForumHomeDataSource.h"
#import "ForumHomeDelegate.h"
#import "Three20UI/UIViewAdditions.h"


////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
@implementation ForumHomeController

////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
#pragma mark - Memory Management

////////////////////////////////////////////////////////////////////////////////////////////////////
- (void)didReceiveMemoryWarning {
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];
    
    // Release any cached data, images, etc that aren't in use.
}

////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
#pragma mark - NSObject

////////////////////////////////////////////////////////////////////////////////////////////////////
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
    
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    
    if (self) {
        // title logo
        self.navigationItem.titleView = TTSTYLEVAR(titleImage);
                
    }
    
    return self;
}

////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
#pragma mark - View lifecycle



////////////////////////////////////////////////////////////////////////////////////////////////////
- (void)viewDidLoad {
    [super viewDidLoad];
    self.tableView.separatorColor = RGBCOLOR(184, 184, 184);
    
    // set the right navigation button
    self.navigationItem.rightBarButtonItem = 
    [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemAction 
                                                  target:self 
                                                  action:@selector(actionSheet)];

    // set the left navigation button
    [[self navigationItem] setLeftBarButtonItem:
     [[UIBarButtonItem alloc] initWithTitle:@"Home" 
                                      style:UIBarButtonItemStylePlain 
                                     target:self 
                                     action:@selector(backToLauncher)]];
}

////////////////////////////////////////////////////////////////////////////////////////////////////
- (void)viewDidUnload {
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

////////////////////////////////////////////////////////////////////////////////////////////////////
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    // Return YES for supported orientations
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
#pragma mark -
#pragma mark - Private

////////////////////////////////////////////////////////////////////////////////////////////////////
- (void)backToLauncher {
    // create a screenshot
    UIGraphicsBeginImageContext(self.view.layer.bounds.size);
    [self.view.layer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage * ss = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    UIImageView * ssImageView = [[UIImageView alloc] initWithImage:ss];
    
    [[NSNotificationCenter defaultCenter] postNotificationName:@"comingHome"
                                                        object:ssImageView];
    
    [self.navigationController popViewControllerAnimated:NO];
}

////////////////////////////////////////////////////////////////////////////////////////////////////
- (void)actionSheet {
    UIActionSheet * sheet = [[UIActionSheet alloc] init];
    [sheet addButtonWithTitle:@"Mark Forums Read"];
    [sheet addButtonWithTitle:@"Cancel"];
    [sheet setCancelButtonIndex:1];
    [sheet setDelegate:self];
    [sheet showInView:self.view];
}

////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
#pragma mark - UIActionSheetDelegate

////////////////////////////////////////////////////////////////////////////////////////////////////
-(void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex {
    if (buttonIndex == 0) {
        MARK;
    } 
}

////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////
#pragma mark TTTableView

////////////////////////////////////////////////////////////////////////////////////////////////////
- (void)createModel {
    self.dataSource = [[ForumHomeDataSource alloc] init];
}

////////////////////////////////////////////////////////////////////////////////////////////////////
- (id<UITableViewDelegate>)createDelegate {
    return [[ForumHomeDelegate alloc] initWithController:self];
}

@end
